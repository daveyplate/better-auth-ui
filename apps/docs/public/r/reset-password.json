{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "reset-password",
  "type": "registry:component",
  "title": "Reset Password",
  "description": "A form component for resetting password with a token from the URL.",
  "dependencies": [
    "@better-auth-ui/react@workspace:*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "card",
    "field",
    "input-group",
    "sonner",
    "spinner"
  ],
  "files": [
    {
      "path": "src/components/auth/reset-password.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { Eye, EyeOff } from \"lucide-react\"\nimport { useEffect, useState } from \"react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport {\n  Field,\n  FieldDescription,\n  FieldError,\n  FieldGroup,\n  FieldLabel\n} from \"@/components/ui/field\"\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupInput\n} from \"@/components/ui/input-group\"\nimport { Spinner } from \"@/components/ui/spinner\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { useResetPassword } from \"@/hooks/auth/use-reset-password\"\nimport { cn } from \"@/lib/utils\"\n\nexport type ResetPasswordProps = AnyAuthConfig & {\n  className?: string\n}\n\n/**\n * Renders a password reset form that validates a token from the URL and submits a new password to the auth client.\n */\nexport function ResetPassword({ className, ...config }: ResetPasswordProps) {\n  const context = useAuth(config)\n\n  const {\n    basePaths,\n    emailAndPassword,\n    localization,\n    viewPaths,\n    navigate,\n    toast,\n    Link\n  } = context\n\n  const [{ password, confirmPassword }, resetPassword, isPending] =\n    useResetPassword(context)\n\n  const [isPasswordVisible, setIsPasswordVisible] = useState(false)\n  const [isConfirmPasswordVisible, setIsConfirmPasswordVisible] =\n    useState(false)\n\n  const [fieldErrors, setFieldErrors] = useState<{\n    password?: string\n    confirmPassword?: string\n  }>({})\n\n  useEffect(() => {\n    const searchParams = new URLSearchParams(window.location.search)\n    const tokenParam = searchParams.get(\"token\")\n\n    if (!tokenParam) {\n      toast.error(localization.auth.invalidResetPasswordToken)\n      navigate(`${basePaths.auth}/${viewPaths.auth.signIn}`)\n    }\n  }, [\n    basePaths.auth,\n    localization.auth.invalidResetPasswordToken,\n    viewPaths.auth.signIn,\n    navigate,\n    toast\n  ])\n\n  return (\n    <Card className={cn(\"w-full max-w-sm py-4 md:py-6\", className)}>\n      <CardHeader className=\"px-4 md:px-6 -mb-4\">\n        <CardTitle className=\"text-xl\">\n          {localization.auth.resetPassword}\n        </CardTitle>\n      </CardHeader>\n\n      <CardContent className=\"px-4 md:px-6\">\n        <form action={resetPassword}>\n          <FieldGroup className=\"gap-4\">\n            <Field className=\"gap-1\">\n              <FieldLabel htmlFor=\"password\">\n                {localization.auth.password}\n              </FieldLabel>\n\n              <InputGroup>\n                <InputGroupInput\n                  id=\"password\"\n                  name=\"password\"\n                  type={isPasswordVisible ? \"text\" : \"password\"}\n                  autoComplete=\"new-password\"\n                  defaultValue={password}\n                  placeholder={localization.auth.newPasswordPlaceholder}\n                  required\n                  minLength={emailAndPassword?.minPasswordLength}\n                  maxLength={emailAndPassword?.maxPasswordLength}\n                  disabled={isPending}\n                  onChange={() => {\n                    setFieldErrors((prev) => ({\n                      ...prev,\n                      password: undefined\n                    }))\n                  }}\n                  onInvalid={(e) => {\n                    e.preventDefault()\n                    setFieldErrors((prev) => ({\n                      ...prev,\n                      password: (e.target as HTMLInputElement).validationMessage\n                    }))\n                  }}\n                  aria-invalid={!!fieldErrors.password}\n                />\n\n                <InputGroupAddon align=\"inline-end\">\n                  <InputGroupButton\n                    aria-label={\n                      isPasswordVisible\n                        ? localization.auth.hidePassword\n                        : localization.auth.showPassword\n                    }\n                    title={\n                      isPasswordVisible\n                        ? localization.auth.hidePassword\n                        : localization.auth.showPassword\n                    }\n                    onClick={() => {\n                      setIsPasswordVisible(!isPasswordVisible)\n                    }}\n                  >\n                    {isPasswordVisible ? <EyeOff /> : <Eye />}\n                  </InputGroupButton>\n                </InputGroupAddon>\n              </InputGroup>\n\n              <FieldError>{fieldErrors.password}</FieldError>\n            </Field>\n\n            {emailAndPassword?.confirmPassword && (\n              <Field className=\"gap-1\">\n                <FieldLabel htmlFor=\"confirmPassword\">\n                  {localization.auth.confirmPassword}\n                </FieldLabel>\n\n                <InputGroup>\n                  <InputGroupInput\n                    id=\"confirmPassword\"\n                    name=\"confirmPassword\"\n                    type={isConfirmPasswordVisible ? \"text\" : \"password\"}\n                    autoComplete=\"new-password\"\n                    defaultValue={confirmPassword}\n                    placeholder={localization.auth.confirmPasswordPlaceholder}\n                    required\n                    minLength={emailAndPassword?.minPasswordLength}\n                    maxLength={emailAndPassword?.maxPasswordLength}\n                    disabled={isPending}\n                    onChange={() => {\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        confirmPassword: undefined\n                      }))\n                    }}\n                    onInvalid={(e) => {\n                      e.preventDefault()\n                      setFieldErrors((prev) => ({\n                        ...prev,\n                        confirmPassword: (e.target as HTMLInputElement)\n                          .validationMessage\n                      }))\n                    }}\n                    aria-invalid={!!fieldErrors.confirmPassword}\n                  />\n\n                  <InputGroupAddon align=\"inline-end\">\n                    <InputGroupButton\n                      aria-label={\n                        isConfirmPasswordVisible\n                          ? localization.auth.hidePassword\n                          : localization.auth.showPassword\n                      }\n                      title={\n                        isConfirmPasswordVisible\n                          ? localization.auth.hidePassword\n                          : localization.auth.showPassword\n                      }\n                      onClick={() => {\n                        setIsConfirmPasswordVisible(!isConfirmPasswordVisible)\n                      }}\n                    >\n                      {isConfirmPasswordVisible ? <EyeOff /> : <Eye />}\n                    </InputGroupButton>\n                  </InputGroupAddon>\n                </InputGroup>\n\n                <FieldError>{fieldErrors.confirmPassword}</FieldError>\n              </Field>\n            )}\n\n            <Field className=\"mt-1\">\n              <Button type=\"submit\" disabled={isPending} className=\"w-full\">\n                {isPending && <Spinner />}\n\n                {localization.auth.resetPassword}\n              </Button>\n            </Field>\n\n            <FieldDescription className=\"flex justify-center gap-1\">\n              {localization.auth.rememberYourPassword}\n\n              <Link\n                href={`${basePaths.auth}/${viewPaths.auth.signIn}`}\n                className=\"underline underline-offset-4\"\n              >\n                {localization.auth.signIn}\n              </Link>\n            </FieldDescription>\n          </FieldGroup>\n        </form>\n      </CardContent>\n    </Card>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-auth.tsx",
      "content": "import {\n  type AnyAuthConfig,\n  type AuthConfig,\n  AuthContext\n} from \"@better-auth-ui/react\"\nimport { deepmerge, defaultConfig } from \"@better-auth-ui/react/core\"\nimport { useContext } from \"react\"\nimport { toast } from \"sonner\"\n\nconst extendConfig: AnyAuthConfig = {\n  toast,\n  Link: (props) => <a {...props} />\n}\n\n/**\n * Constructs the effective AuthConfig by merging defaults, any AuthContext-provided config, and the optional `config` overrides.\n *\n * @param config - Partial configuration overrides applied on top of context and defaults\n * @returns The final `AuthConfig` with a non-optional `authClient`\n * @throws If the resulting config does not include an `authClient`\n */\nexport function useAuth(config?: AnyAuthConfig) {\n  const context = useContext(AuthContext)\n\n  const authConfig = deepmerge(\n    deepmerge(defaultConfig as AnyAuthConfig, extendConfig),\n    deepmerge(context || {}, config || {})\n  ) as AuthConfig\n\n  if (authConfig.authClient === undefined) {\n    throw new Error(\"[Better Auth UI] authClient is required\")\n  }\n\n  return authConfig\n}\n",
      "type": "registry:hook"
    },
    {
      "path": "../react/src/hooks/auth/use-reset-password.ts",
      "content": "import type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { useActionState } from \"react\"\n\nimport { useAuth } from \"./use-auth\"\n\nexport function useResetPassword(config?: AnyAuthConfig) {\n  const {\n    authClient,\n    basePaths,\n    emailAndPassword,\n    localization,\n    toast,\n    viewPaths,\n    navigate\n  } = useAuth(config)\n\n  const resetPassword = async (_: object, formData: FormData) => {\n    const password = formData.get(\"password\") as string\n    const confirmPassword = formData.get(\"confirmPassword\") as string\n\n    const searchParams = new URLSearchParams(window.location.search)\n    const token = searchParams.get(\"token\")\n\n    if (!token) {\n      toast.error(localization.auth.invalidResetPasswordToken)\n      navigate(`${basePaths.auth}/${viewPaths.auth.signIn}`)\n\n      return {\n        password: \"\",\n        ...(emailAndPassword?.confirmPassword ? { confirmPassword: \"\" } : {})\n      }\n    }\n\n    // Validate confirmPassword if enabled\n    if (emailAndPassword?.confirmPassword) {\n      if (password !== confirmPassword) {\n        toast.error(localization.auth.passwordsDoNotMatch)\n\n        return {\n          password: \"\",\n          confirmPassword: \"\"\n        }\n      }\n    }\n\n    const { error } = await authClient.resetPassword({\n      token,\n      newPassword: password\n    })\n\n    if (error) {\n      toast.error(error.message || error.statusText)\n\n      return {\n        password: \"\",\n        confirmPassword: \"\"\n      }\n    }\n\n    toast.success(localization.auth.passwordResetSuccess)\n    navigate(`${basePaths.auth}/${viewPaths.auth.signIn}`)\n\n    return {\n      password,\n      confirmPassword\n    }\n  }\n\n  return useActionState(resetPassword, {\n    password: \"\",\n    confirmPassword: \"\"\n  })\n}\n",
      "type": "registry:hook"
    }
  ]
}
