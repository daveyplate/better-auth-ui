{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "user-button",
  "type": "registry:component",
  "title": "User Button",
  "description": "Renders a user button with dropdown menu showing user info and sign out option.",
  "dependencies": [
    "@better-auth-ui/react@workspace:*",
    "better-auth",
    "lucide-react"
  ],
  "registryDependencies": ["avatar", "button", "dropdown-menu", "skeleton"],
  "files": [
    {
      "path": "src/components/user/user-button.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport { ChevronsUpDown, LogIn, LogOut, UserPlus2 } from \"lucide-react\"\n\nimport { Button } from \"@/components/ui/button\"\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger\n} from \"@/components/ui/dropdown-menu\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { cn } from \"@/lib/utils\"\nimport { UserAvatar } from \"./user-avatar\"\n\nexport type UserButtonProps = AnyAuthConfig & {\n  className?: string\n  align?: \"center\" | \"end\" | \"start\" | undefined\n  sideOffset?: number\n  size?: \"default\" | \"icon\"\n  variant?:\n    | \"default\"\n    | \"destructive\"\n    | \"ghost\"\n    | \"link\"\n    | \"outline\"\n    | \"secondary\"\n}\n\n/**\n * Renders a user button with dropdown menu showing user info and sign out option.\n */\nexport function UserButton({\n  className,\n  align,\n  sideOffset,\n  size = \"default\",\n  variant = \"ghost\",\n  ...config\n}: UserButtonProps) {\n  const { authClient, basePaths, viewPaths, localization, Link } =\n    useAuth(config)\n\n  const { data: sessionData, isPending } = authClient.useSession()\n\n  const user = sessionData?.user\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild={size === \"default\"}>\n        {size === \"icon\" ? (\n          <UserAvatar {...config} user={user} />\n        ) : (\n          <Button variant={variant} className={cn(\"h-auto\", className)}>\n            <UserAvatar {...config} user={user} />\n\n            {isPending ? (\n              <div className=\"grid flex-1 gap-1 text-left text-sm leading-tight\">\n                <Skeleton className=\"h-4 w-24\" />\n                <Skeleton className=\"h-3 w-32\" />\n              </div>\n            ) : user ? (\n              <div className=\"grid flex-1 text-left text-sm leading-tight\">\n                <span className=\"truncate font-medium\">\n                  {user.displayUsername || user.name || user.email}\n                </span>\n\n                {(user.displayUsername || user.name) && (\n                  <span className=\"text-muted-foreground truncate text-xs\">\n                    {user.email}\n                  </span>\n                )}\n              </div>\n            ) : (\n              <div className=\"grid flex-1 text-left text-sm leading-tight\">\n                {localization.auth.account}\n              </div>\n            )}\n\n            <ChevronsUpDown className=\"ml-auto\" />\n          </Button>\n        )}\n      </DropdownMenuTrigger>\n\n      <DropdownMenuContent\n        className=\"w-[--radix-dropdown-menu-trigger-width] min-w-56 rounded-lg\"\n        sideOffset={sideOffset}\n        align={align}\n        onCloseAutoFocus={(e) => e.preventDefault()}\n      >\n        {user && (\n          <>\n            <DropdownMenuLabel className=\"p-0 font-normal\">\n              <div className=\"flex items-center gap-2 px-1 py-1.5 text-left text-sm\">\n                <UserAvatar {...config} user={user} />\n\n                <div className=\"grid flex-1 text-left text-sm leading-tight\">\n                  <span className=\"truncate font-medium\">\n                    {user.displayUsername || user.name || user.email}\n                  </span>\n\n                  {(user.displayUsername || user.name) && (\n                    <span className=\"text-muted-foreground truncate text-xs\">\n                      {user.email}\n                    </span>\n                  )}\n                </div>\n              </div>\n            </DropdownMenuLabel>\n\n            <DropdownMenuSeparator />\n          </>\n        )}\n\n        {user ? (\n          <DropdownMenuItem asChild>\n            <Link href={`${basePaths.auth}/${viewPaths.auth.signOut}`}>\n              <LogOut />\n\n              {localization.auth.signOut}\n            </Link>\n          </DropdownMenuItem>\n        ) : (\n          <>\n            <DropdownMenuItem asChild>\n              <Link href={`${basePaths.auth}/${viewPaths.auth.signIn}`}>\n                <LogIn />\n\n                {localization.auth.signIn}\n              </Link>\n            </DropdownMenuItem>\n\n            <DropdownMenuItem asChild>\n              <Link href={`${basePaths.auth}/${viewPaths.auth.signUp}`}>\n                <UserPlus2 />\n\n                {localization.auth.signUp}\n              </Link>\n            </DropdownMenuItem>\n          </>\n        )}\n      </DropdownMenuContent>\n    </DropdownMenu>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/components/user/user-avatar.tsx",
      "content": "\"use client\"\n\nimport type { AnyAuthConfig } from \"@better-auth-ui/react\"\nimport type { User } from \"better-auth\"\nimport { User2 } from \"lucide-react\"\nimport type { ReactNode } from \"react\"\n\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport { useAuth } from \"@/hooks/auth/use-auth\"\nimport { cn } from \"@/lib/utils\"\n\nexport type UserAvatarProps = AnyAuthConfig & {\n  className?: string\n  fallback?: ReactNode\n  isPending?: boolean\n  rounded?: boolean\n  user?: User & { username?: string | null }\n}\n\n/**\n * Renders the current user's avatar using session data.\n * Shows a skeleton while loading and falls back to initials when no image is available.\n */\nexport function UserAvatar({\n  className,\n  user,\n  isPending,\n  fallback,\n  rounded,\n  ...config\n}: UserAvatarProps) {\n  const { authClient } = useAuth(config)\n\n  const { data: sessionData, isPending: sessionPending } =\n    authClient.useSession()\n\n  if ((isPending || sessionPending) && !user) {\n    return (\n      <Skeleton\n        className={cn(\n          \"size-8\",\n          rounded ? \"rounded-full\" : \"rounded-lg\",\n          className\n        )}\n      />\n    )\n  }\n\n  const resolvedUser = user ?? sessionData?.user\n\n  const initials =\n    resolvedUser?.username?.slice(0, 2).toUpperCase() ||\n    resolvedUser?.name?.slice(0, 2).toUpperCase() ||\n    resolvedUser?.email?.slice(0, 2).toUpperCase()\n\n  return (\n    <Avatar\n      className={cn(\n        \"size-8\",\n        rounded ? \"rounded-full\" : \"rounded-lg\",\n        className\n      )}\n    >\n      <AvatarImage\n        src={resolvedUser?.image ?? undefined}\n        alt={\n          resolvedUser?.username || resolvedUser?.name || resolvedUser?.email\n        }\n      />\n\n      <AvatarFallback\n        className={cn(\n          \"text-foreground text-sm font-normal\",\n          rounded ? \"rounded-full\" : \"rounded-lg\"\n        )}\n      >\n        {initials ? initials : fallback || <User2 className=\"size-4\" />}\n      </AvatarFallback>\n    </Avatar>\n  )\n}\n",
      "type": "registry:component"
    },
    {
      "path": "src/hooks/auth/use-auth.tsx",
      "content": "import {\n  type AnyAuthConfig,\n  type AuthConfig,\n  AuthContext\n} from \"@better-auth-ui/react\"\nimport { deepmerge, defaultConfig } from \"@better-auth-ui/react/core\"\nimport { useContext } from \"react\"\nimport { toast } from \"sonner\"\n\nconst extendConfig: AnyAuthConfig = {\n  toast,\n  Link: (props) => <a {...props} />\n}\n\n/**\n * Constructs the effective AuthConfig by merging defaults, any AuthContext-provided config, and the optional `config` overrides.\n *\n * @param config - Partial configuration overrides applied on top of context and defaults\n * @returns The final `AuthConfig` with a non-optional `authClient`\n * @throws If the resulting config does not include an `authClient`\n */\nexport function useAuth(config?: AnyAuthConfig) {\n  const context = useContext(AuthContext)\n\n  const authConfig = deepmerge(\n    deepmerge(defaultConfig as AnyAuthConfig, extendConfig),\n    deepmerge(context || {}, config || {})\n  ) as AuthConfig\n\n  if (authConfig.authClient === undefined) {\n    throw new Error(\"[Better Auth UI] authClient is required\")\n  }\n\n  return authConfig\n}\n",
      "type": "registry:hook"
    }
  ]
}
