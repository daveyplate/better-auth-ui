{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "organization-name-card",
  "type": "registry:component",
  "title": "Organization Name Card",
  "description": "",
  "dependencies": [
    "@hookform/resolvers",
    "better-auth",
    "react-hook-form",
    "zod"
  ],
  "registryDependencies": [
    "true/auth-ui-provider.json",
    "card",
    "form",
    "input",
    "true/settings-card.json",
    "skeleton",
    "true/use-current-organization.json",
    "true/utils.json"
  ],
  "files": [
    {
      "path": "src/components/organization/organization-name-card.tsx",
      "content": "\"use client\"\n\nimport { zodResolver } from \"@hookform/resolvers/zod\"\nimport type { Organization } from \"better-auth/plugins/organization\"\nimport { useContext, useMemo } from \"react\"\nimport { useForm } from \"react-hook-form\"\nimport * as z from \"zod\"\n\nimport { useCurrentOrganization } from \"../../hooks/use-current-organization\"\nimport { AuthUIContext } from \"../../lib/auth-ui-provider\"\nimport { cn, getLocalizedError } from \"../../lib/utils\"\nimport {\n    SettingsCard,\n    type SettingsCardProps\n} from \"../settings/shared/settings-card\"\nimport { CardContent } from \"../ui/card\"\nimport { Form, FormControl, FormField, FormItem, FormMessage } from \"../ui/form\"\nimport { Input } from \"../ui/input\"\nimport { Skeleton } from \"../ui/skeleton\"\n\nexport interface OrganizationNameCardProps extends SettingsCardProps {\n    slug?: string\n}\n\nexport function OrganizationNameCard({\n    className,\n    classNames,\n    localization: localizationProp,\n    slug,\n    ...props\n}: OrganizationNameCardProps) {\n    const { localization: contextLocalization } = useContext(AuthUIContext)\n\n    const localization = useMemo(\n        () => ({ ...contextLocalization, ...localizationProp }),\n        [contextLocalization, localizationProp]\n    )\n\n    const { data: organization } = useCurrentOrganization({ slug })\n\n    if (!organization) {\n        return (\n            <SettingsCard\n                className={className}\n                classNames={classNames}\n                actionLabel={localization.SAVE}\n                description={localization.ORGANIZATION_NAME_DESCRIPTION}\n                instructions={localization.ORGANIZATION_NAME_INSTRUCTIONS}\n                isPending\n                title={localization.ORGANIZATION_NAME}\n                {...props}\n            >\n                <CardContent className={classNames?.content}>\n                    <Skeleton\n                        className={cn(\"h-9 w-full\", classNames?.skeleton)}\n                    />\n                </CardContent>\n            </SettingsCard>\n        )\n    }\n\n    return (\n        <OrganizationNameForm\n            className={className}\n            classNames={classNames}\n            localization={localization}\n            organization={organization}\n            {...props}\n        />\n    )\n}\n\nfunction OrganizationNameForm({\n    className,\n    classNames,\n    localization: localizationProp,\n    organization,\n    ...props\n}: OrganizationNameCardProps & { organization: Organization }) {\n    const {\n        localization: contextLocalization,\n        hooks: { useHasPermission },\n        mutators: { updateOrganization },\n        optimistic,\n        toast\n    } = useContext(AuthUIContext)\n\n    const localization = { ...contextLocalization, ...localizationProp }\n\n    const { data: hasPermission, isPending: permissionPending } =\n        useHasPermission({\n            organizationId: organization.id,\n            permissions: {\n                organization: [\"update\"]\n            }\n        })\n\n    const { refetch: refetchOrganization } = useCurrentOrganization({\n        slug: organization.slug\n    })\n\n    const isPending = permissionPending\n\n    const formSchema = z.object({\n        name: z.string().min(1, {\n            message: `${localization.ORGANIZATION_NAME} ${localization.IS_REQUIRED}`\n        })\n    })\n\n    const form = useForm({\n        resolver: zodResolver(formSchema),\n        values: { name: organization.name || \"\" }\n    })\n\n    const { isSubmitting } = form.formState\n\n    const updateOrganizationName = async ({\n        name\n    }: z.infer<typeof formSchema>) => {\n        if (organization.name === name) {\n            toast({\n                variant: \"error\",\n                message: `${localization.ORGANIZATION_NAME} ${localization.IS_THE_SAME}`\n            })\n\n            return\n        }\n\n        try {\n            await updateOrganization({\n                organizationId: organization.id,\n                data: { name }\n            })\n\n            await refetchOrganization?.()\n\n            toast({\n                variant: \"success\",\n                message: `${localization.ORGANIZATION_NAME} ${localization.UPDATED_SUCCESSFULLY}`\n            })\n        } catch (error) {\n            toast({\n                variant: \"error\",\n                message: getLocalizedError({ error, localization })\n            })\n        }\n    }\n\n    return (\n        <Form {...form}>\n            <form onSubmit={form.handleSubmit(updateOrganizationName)}>\n                <SettingsCard\n                    className={className}\n                    classNames={classNames}\n                    description={localization.ORGANIZATION_NAME_DESCRIPTION}\n                    instructions={localization.ORGANIZATION_NAME_INSTRUCTIONS}\n                    isPending={isPending}\n                    title={localization.ORGANIZATION_NAME}\n                    actionLabel={localization.SAVE}\n                    optimistic={optimistic}\n                    disabled={!hasPermission?.success}\n                    {...props}\n                >\n                    <CardContent className={classNames?.content}>\n                        {isPending ? (\n                            <Skeleton\n                                className={cn(\n                                    \"h-9 w-full\",\n                                    classNames?.skeleton\n                                )}\n                            />\n                        ) : (\n                            <FormField\n                                control={form.control}\n                                name=\"name\"\n                                render={({ field }) => (\n                                    <FormItem>\n                                        <FormControl>\n                                            <Input\n                                                className={classNames?.input}\n                                                placeholder={\n                                                    localization.ORGANIZATION_NAME_PLACEHOLDER\n                                                }\n                                                disabled={\n                                                    isSubmitting ||\n                                                    !hasPermission?.success\n                                                }\n                                                {...field}\n                                            />\n                                        </FormControl>\n\n                                        <FormMessage\n                                            className={classNames?.error}\n                                        />\n                                    </FormItem>\n                                )}\n                            />\n                        )}\n                    </CardContent>\n                </SettingsCard>\n            </form>\n        </Form>\n    )\n}\n",
      "type": "registry:component"
    }
  ]
}